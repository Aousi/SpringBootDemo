<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>newArticle</title>
    <!--<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"-->
    <!--integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">-->
    <link type="text/css" rel="stylesheet" th:href="@{/css/bootstrap.css}">
    <link type="text/css" rel="stylesheet" th:href="@{/css/bootstrap-select.css}">
    <link type="text/css" rel="stylesheet" href="/static/css/bootstrap.css">
    <link type="text/css" rel="stylesheet" href="/static/css/bootstrap-select.css">
    <style>
        .myfooter {
            background-color: #5f5f5f;
        }

        .myfooter a,p{
            margin-left: 10px;
        }

        .myfooter div{
            margin-top: 30px;
        }

        .postInfoSpan {
            margin-left: 10px;
            margin-right: 5px;
        }
        .btnDiv{
            margin: 5px 20px;
        }
    </style>
</head>
<script th:src="@{/js/jquery.min.js}"></script>
<script th:src="@{/js/bootstrap.min.js}"></script>
<script th:src="@{/js/UEditor/ueditor.config.js}"></script>
<script th:src="@{/js/UEditor/ueditor.all.js}"></script>
<script th:src="@{/js/bootstrap-select.min.js}"></script>
<script th:src="@{/js/defaults-zh_CN.min.js}"></script>
<!--<script type="text/javascript" src="/static/js/bootstrap-select.min.js"></script>-->
<!--<script type="text/javascript" src="/static/js/defaults-zh_CN.min.js"></script>-->
<!--<script type="text/javascript" src="/static/js/jquery.min.js"></script>-->
<!--<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>-->


<!--<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>-->
<!--<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"-->
<!--integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>-->
<body>

<div class="nav navbar-default mynav">
    <div class="container-fluid">
        <div class="navbar-header">
            <div class="navbar-brand"><span style="font-size: 39px">Index</span></div>

            <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#LinkPart"
                    aria-controls="bs-navbar" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
        <div id="LinkPart" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a href="#"  class="dropdown-toggle" data-toggle="dropdown" Role="button" aria-haspopup="true"
                       aria-expanded="false">文章<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="/articleList">文章列表</a></li>
                        <li role="separator" class="divider"></li>
                        <li><a href="/newArticle">发文</a></li>
                        <li><a href="/myArticle">我的文章</a></li>
                        <li><a href="/recycledArticle">回收站</a></li>
                    </ul>
                </li>
                <li><a href="#">PART 3</a></li>
                <li class="dropdown">
                    <a href="#"  class="dropdown-toggle" data-toggle="dropdown" Role="button" aria-haspopup="true"
                       aria-expanded="false">SELECT<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#">PART 1</a></li>
                        <li><a href="#">PART 2</a></li>
                        <li><a href="#">PART 3</a></li>
                    </ul>
                </li>
            </ul>
            <input id="nameNav" type="hidden" th:value="${name}" >
            <ul class="nav navbar-nav navbar-right" id="userNav">
                <li><a href="#">LOGIN or SIGN UP</a></li>
            </ul>
        </div>
    </div>
</div>

<main style="width: 960px;margin: 0 auto">
    <div>
        <ol class="breadcrumb">
            <li><a href="/home">首页</a></li>
            <li class="active">发布文章</li>
        </ol>
    </div>
    <div class="container" style="width: inherit">
        <div class="page-header col-md-12 col-sm-12 col-xs-12">
            <h1>发文 <small>New Article</small></h1>
        </div>

        <div class="form-group col-md-12 col-sm-12 col-xs-12">
            <label for="articleTitle">Title</label>
            <input type="text" id="articleTitle" class="form-control" placeholder="title"  >
            <input type="hidden" id="articleAuthor" >
        </div>
        <div class="row" style="margin: 0 auto">
            <div class="form-group col-md-4 col-sm-12 col-xs-12">
                <label for="articleCode">articleCode</label><br>
                <input type="text" id="articleCode" class="form-control" placeholder="Code" style="width: 220px">
            </div>
            <div class="form-group col-md-4 col-sm-12 col-xs-12">
                <label for="articleLevel">articleLevel</label><br>
                <select class="selectpicker" id="articleLevel" >
                    <option title="Normal">1</option>
                    <option title="Critical">2</option>
                </select>
            </div>
            <div class="form-group col-md-4 col-sm-12 col-xs-12">
                <label for="articleType">articleType</label><br>
                <select class="selectpicker" id="articleType" >
                    <option title="Article">1</option>
                    <option title="Document">2</option>
                </select>
            </div>
        </div>
        <!--<div class="form-group col-md-12 col-sm-12 col-xs-12">-->
            <!--<p><label for="uploadBtn">upload</label></p>-->
            <!--<form id="fileUpload" method="post" enctype="multipart/form-data">-->
                <!--<p>-->
                    <!--选择上传文件：<input type="file" name="fileName"><button id="uploadBtn" class="btn btn-primary" onclick="fileUpload()">submit</button>-->
                <!--</p>-->
            <!--</form>-->
        <!--</div>-->

        <div class="form-group col-md-12 col-sm-12 col-xs-12" style=" margin-top: 20px;min-height: 500px">
            <label for="ueditor">Context Editor</label>
            <script id="ueditor" type="text/plain" name="content"></script>
        </div>

        <div style="text-align: center">
            <button class="btn btn-primary btnDiv" onclick="submit()">submit</button>
            <button class="btn btn-default btnDiv" onclick="saveAsDraft()">save as draft</button>
        </div>
    </div>
</main>

<footer class="myfooter" style="height: 150px">
    <div class="container" style="text-align: left">
        <div>
            <a href="#">PART 1</a>
            <a href="#">PART 2</a>
            <a href="#">PART 3</a>
        </div>
        <br><br>
        <p>版权声明</p>
    </div>

</footer>
</body>
<!--<script  th:src="@{/js/UEditor/ueditor.config.js}"></script>-->
<!--<script th:src="@{/js/UEditor/ueditor.all.js}"></script>-->
<!--<script type="text/javascript" src="/static/js/UEditor/ueditor.config.js"></script>-->
<!--<script type="text/javascript" src="/static/js/UEditor/ueditor.all.js"></script>-->
<script type="text/javascript">
    $(function () {
        var data = window.sessionStorage.getItem('name');
        if (data !=""){
            $('#userNav').html('<li class="dropdown">\n' +
                ' <a href="#"  class="dropdown-toggle" data-toggle="dropdown" Role="button" aria-haspopup="true"\n' +
                ' aria-expanded="false" >'+data+'<span class="caret"></span></a>\n' +
                ' <ul class="dropdown-menu">\n' +
                ' <li><a href="/user/getPerson.do?name='+data+'">个人信息</a></li>\n' +
                ' <li><a href="#">PART 2</a></li>\n' +
                ' <li><a href="#">PART 3</a></li>\n' +
                ' </ul>\n' +
                ' </li>' +
                '<li><a href="#">log out</a></li>')
        }
    })

    var ue = UE.getEditor('ueditor');

    function fileUpload() {

        var form = $('#fileUpload')[0];
        var data = new FormData(form);


        $.ajax({
            type: "POST",
            enctype: 'multipart/form-data',
            url: "/upload/fileUpload",
            data: data,
            processData: false, //prevent jQuery from automatically transforming the data into a query string
            contentType: false,
            cache: false,
            timeout: 600000,
            success: function (data) {

                $("#result").text(data);
                console.log("SUCCESS : ", data);
                $("#btnSubmit").prop("disabled", false);

            },
            error: function (e) {

                $("#result").text(e.responseText);
                console.log("ERROR : ", e);
                $("#btnSubmit").prop("disabled", false);

            }
        })

    }

    function saveAsDraft() {
        tools(0);
    }
    function submit() {
        tools(1);
    }

    function tools(flag) {
        var title = $('#articleTitle').val();
        var author = $('#articleAuthor').val();
        var context = UE.getEditor('ueditor').getContent();
        var code =$('#articleCode').val();
        var level =$('#articleLevel').val();
        var type =$('#articleType').val();
        var flag = flag;

        var data = {
            "title": title,
            "author": author,
            "context": context,
            "code": code,
            "level": level,
            "type": type,
            "flag": flag
        }

        $.ajax({
            url: "/Article/submit.do",
            type: "POST",
            dataType: "json",
            data: data,
            success: function (data) {
                if (data.stateCode == 200) {
                    alert(data.msg);
                }
            }
        })
    }
</script>
</html>